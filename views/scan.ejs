<!DOCTYPE html>
<html>
<head>
  <title>Scan Item - Admin</title>
</head>
<body>
  <h1>Item Scan: <%= item.name %></h1>
  <p>Description: <%= item.description %></p>
  <p>Status: <%= item.status %></p>
  <p>Storage / Delivery: <%= item.storage_choice %></p>
  <p>Instructions: <%= item.instructions %></p>
  <img src="<%= item.qr %>" width="150">

  <h2>Countdown to drop-off:</h2>
  <p id="countdown"></p>

  <script>
    const minutes = parseInt("<%= item.dropoff_time.includes('3') ? 3 : 5 %>");
    const arrivalTime = new Date(new Date().getTime() + minutes*60000);

    function updateCountdown() {
      const now = new Date();
      const diff = arrivalTime - now;
      if(diff <= 0) document.getElementById('countdown').innerText = "Item should be at your door!";
      else {
        const m = Math.floor(diff/60000);
        const s = Math.floor((diff%60000)/1000);
        document.getElementById('countdown').innerText = `${m}m ${s}s`;
      }
    }
    setInterval(updateCountdown, 1000);
    updateCountdown();
  </script>
</body>
</html>
